import os

import pandas as pd

old_male_29_ids = [1021945080, 1021944909, 1021931728, 1021930182, 1021928778, 1021928664, 1021917838, 1021896721,
                   1021891734, 1021891302, 1021890569, 1021881591, 1021874392, 1021872603, 1021871528, 1021510658,
                   1021491275, 1021451786, 1021448399, 1021444879, 1021422398, 1021409917, 1021393926, 1021391615,
                   1021381855, 1021381502, 1021380890, 1021359470, 1021344537, 1021338681, 1021335045, 1021333916,
                   1021326723, 1021325061, 1021321557, 1021309705, 1021297789, 1021290647, 1021290340, 1021287912,
                   1021282381, 1021276804, 1021275928, 1021258472, 1021249197, 1021226418, 1021217033, 1021210904,
                   1021206369, 1021191732, 1021188487, 1021185819, 1021180415, 1021174121, 1021170904, 1021168685,
                   1021164165, 1021158569, 1021151029, 1021150066, 1021148486, 1021147905, 1021133005, 1021128985,
                   1021125198, 1021112223, 1021095769, 1021091467, 1021085765, 1021078569, 1021076397, 1021074303,
                   1021067155, 1021060048, 1021059915, 1021057483, 1021053658, 1021046032, 1021044680, 1021021572,
                   1021006639, 1021000389, 1020995472, 1020986311, 1020981439, 1020979876, 1020978090, 1020977593,
                   1020974430, 1020972669, 1020969933, 1020966399, 1020964063, 1020957213, 1020949450, 1020947806,
                   1020947734, 1020944232, 1020942515, 1020941986, 1020941422, 1020939187, 1020932835, 1020931054,
                   1020929336, 1020919569, 1020915109, 1020912437, 1020905609, 1020901224, 1020897363, 1020888817,
                   1020888739, 1020883461, 1020883352, 1020882516, 1020869709, 1020869523, 1020868480, 1020864530,
                   1020863983, 1020863867, 1020860880, 1020857657, 1020856601, 1020854447, 1020850602, 1020846075,
                   1020845672, 1020844311, 1020842106, 1020841069, 1020840368, 1020839830, 1020836352, 1020835718,
                   1020833526, 1020831791, 1020831039, 1020824754, 1020824424, 1020821623, 1020815281, 1020813858,
                   1020810721, 1020808497, 1025101597, 1025090597, 1024397515, 1024390696, 1024375313, 1024361986,
                   1024352153, 1024349696, 1024328883, 1024302158, 1024266901, 1024252254, 1024237384, 1024221967,
                   1024189112, 1024174758, 1024173562, 1024152259, 1024150368, 1024117216, 1024113924, 1024104863,
                   1024094432, 1024075440, 1023817123, 1023745795, 1023382695, 1023363370, 1022871151, 1022863198,
                   1022847945, 1022847001, 1022836498, 1022834740, 1022805434, 1022768100, 1022761351, 1022753225,
                   1022742263, 1022651918, 1022550861, 1022410230, 1022399460, 1022386866, 1022349875, 1022304236,
                   1022294103, 1022286908, 1022272766, 1022256514, 1022205776, 1022143970, 1022118862, 1022118362,
                   1022089615, 1022059400, 1022049586, 1022034954, 1022004716, 1021996071, 1021995735, 1021988984,
                   1021962709, 1021957467, 1021948216, 1021932957, 1020806582, 1020805928, 1020805915, 1020804685,
                   1020804020, 1020803390, 1020803002, 1020802335, 1020801429, 1020772880, 1020765856, 1020765555,
                   1020765493, 1020765079, 1020763998, 1020763178, 1020762114, 1020761727, 1020759985]


def reverse_old_male_29(df):
    to_reverse_column = '"Насколько вы согласны с утверждением (1 - полностью НЕ согласен, \n10 - полностью согласен)"" / Религия НЕ играет важную роль в моей жизни'
    df.loc[df['ID'].isin(old_male_29_ids), to_reverse_column] = 11 - df[df['ID'].isin(old_male_29_ids)][to_reverse_column]


def clean_raw_answers(input_dir_path, output_dir_path):
    df = pd.read_excel(f'{input_dir_path}/answers.xlsx')
    question_col = 'Согласны ли вы с утверждением: Религия играет важную роль в моей жизни.'
    df[question_col] = df[question_col].str.replace('согласнен', 'согласен')

    reverse_old_male_29(df)

    groups = ['male_29', 'female_29', 'male_30_49', 'female_30_49', 'male_50', 'female_50']
    for group in df['Источник ответов'].unique():
        if group not in groups:
            continue
        group_df = df[df['Источник ответов'] == group]
        group_df.to_csv(f'{output_dir_path}/{group}.csv', index=False)


if __name__ == '__main__':
    clean_raw_answers()
